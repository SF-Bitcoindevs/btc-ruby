#merkle_tree_spec.rb
require 'spec_helper'

describe Btc::MerkleTree do
  describe '#root' do
    it 'calculates genesis block merkle root' do
      myd = "01000000010000000000000000000000000000000000000000000000000000000000000000FFFFFFFF4D04FFFF001D0104455468652054696D65732030332F4A616E2F32303039204368616E63656C6C6F72206F6E206272696E6B206F66207365636F6E64206261696C6F757420666F722062616E6B73FFFFFFFF0100F2052A01000000434104678AFDB0FE5548271967F1A67130B7105CD6A828E03909A67962E0EA1F61DEB649F6BC3F4CEF38C4F35504E51EC112DE5C384DF7BA0B8D578A4C702B6BF11D5FAC00000000"
      t = Btc::MerkleTree.new
      t.blocks = [[myd].pack('H*')]
      t.root.reverse.unpack('H*').should == ["4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b"] 
    end

    it 'calculates a merkle root' do
      t = Btc::MerkleTree.new
      t.blocks = ['1', '2', '3']
      t.root.reverse.unpack('H*').should == ["015aff31b925a048ad1ff3c3b574abff899df3759045e7a74f1197311234755b"] 
    end
  end
end